"use strict";!function(){function e(e){if(!(e.origin.indexOf(r)<0&&e.origin.indexOf("dowjones.com")<0)&&"string"==typeof e.data&&"DJSSO"===e.data.substr(0,5)){if(n.contentWindow==e.source)t(5,"detected Iframe With Same source Origin: ",n.contentWindow,e.source,e.source.parent,e.data);else if(n.contentWindow==e.source.parent)t(5,"contentWindow === e.source.parent",e.data);else{if(0!=n.src.indexOf(e.origin))return void t(5,"invalid message received");t(5,"X-Origin opIFrame Found",e.data)}try{var o=e.data.split("|")[2],i=JSON.parse(o);switch(i.name){case"run-sso":g+=c.length,w.generateSsoIframes(document.getElementsByTagName("body")[0],i.action,i.session);break;case"iframe-done":w.onIframeCompleted.call(w,i.data.frameId);break;case"third-party-enabled":I&&v.hideTpcMessage();break;case"third-party-disabled":!I&&y&&(v.showTpcMessage(),b&&b.addEventListener("click",function(e){"tpc-close"===e.target.getAttribute("data-type")&&(document.cookie="djcs_tpcack=1",I&&v.hideTpcMessage())}))}}catch(a){console.error("event data not JSON",e)}}}function t(e){if(document.cookie.indexOf("djcs_debug")>-1){var t=parseInt(document.cookie.match(/djcs_debug=(\d+)/)[1],10);t==e&&console.log(arguments)}}var n,o="https://accounts.dowjones.com",i="https://sso.accounts.dowjones.com",a="5hssEAdMy0mJTICnJNvC9TXEw3Va7jfO",r=window.location.host.replace(/^.*?([\w\d\-]+\.[\w\d\:]+)\r?$/,"$1"),s="//accounts.",d="wsj.com,marketwatch.com,barrons.com",c=d?d.split(","):[],l=parseInt("200",10),m=parseInt("7000",10),u="width:0;height:0;border:none",p=r.indexOf(":"),f=!1,g=0;p>-1&&(r=r.substr(0,p));var h=r,w={ssoSecondaryIframes:{},pollingInterval:null,runTimeout:null,generateSsoIframes:function(e,t,n){for(var o=0;o<c.length;o++){var i=c[o].trim();if(r!==i){var a=(new Date).getTime(),s="iframe-rp-"+i+"-"+a,d=this.createIframe(s,i,t,n);this.ssoSecondaryIframes[s]=this.onIframeCompleted.bind(this),e.appendChild(d)}}},createIframe:function(e,t,n,r){var d=t.split(".")[0];"marketwatch"===d&&(d="mw");var c=document.createElement("iframe");c.setAttribute("id",e);var l=window.location.protocol+s+t,m=l+"/assets/secondary-rp-sync.html?iframe_id="+encodeURIComponent(e),p="";if("logout"==n){var f=o.replace("dowjones.com",t);p=f+"/auth/sso/logout?rr=off&url="+encodeURIComponent(m)}else{var g="url="+m+"&brand="+d+"&sess="+r+"&secondary=1",h="response_type=code&client_id="+a+"&state="+encodeURIComponent(g)+"&scope=openid idp_id given_name family_name email&redirect_uri="+o+"/auth/callback";p=i+"/authorize?"+h+"&prompt=none"}return c.setAttribute("src",p),c.setAttribute("style",u),c},startPolling:function(){null===this.pollingInterval&&null===this.runTimeout&&(this.pollingInterval=setInterval(this.checkForCompletion.bind(this),l),this.runTimeout=setTimeout(this.onTimeoutExpired.bind(this),m))},checkForCompletion:function(){0===Object.keys(this.ssoSecondaryIframes).length&&(clearTimeout(this.runTimeout),clearInterval(this.pollingInterval),this.runTimeout=null,this.pollingInterval=null)},onTimeoutExpired:function(){clearInterval(this.pollingInterval),this.runTimeout=null,this.pollingInterval=null,this.clearIframes()},onIframeCompleted:function(e){delete this.ssoSecondaryIframes[e],document.getElementsByTagName("body")[0].removeChild(document.getElementById(e))},clearIframes:function(){for(var e in this.ssoSecondaryIframes)this.ssoSecondaryIframes[e](e)}},v={showTpcMessage:function(){var e=document.createElement("div");e.setAttribute("class","tpc-msg"),e.setAttribute("id","djtpd-message"),e.innerHTML=S;var t=document.createElement("style");t.innerText=C,document.getElementsByTagName("head")[0].appendChild(t);var n=document.getElementsByTagName("body")[0],o=n.firstChild;n.insertBefore(e,o),I=!0},hideTpcMessage:function(){var e=document.getElementById("djtpd-message");e.parentNode.removeChild(e),I=!1},getCookie:function(e,t){function n(e){return e.replace(/([.*+?\^${}()|\[\]\/\\])/g,"\\$1")}var o=t?t:document.cookie,i=o.match(RegExp("(?:^|;\\s*)"+n(e)+"=([^;]*)"));return i?i[1]:null},deleteCookie:function(e,t){t.cookie=e+"=; Domain=."+h+"; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"}},y=document.cookie.indexOf("djcs_tpcack=1")<0,I=!1,b=document.getElementsByTagName("body")[0],T=[],E=v.getCookie("run-sso"),k=v.getCookie("djcs_route");E&&k&&(v.deleteCookie("run-sso",document),g+=c.length,w.generateSsoIframes(document.getElementsByTagName("body")[0],"login",k)),window.addEventListener("rp-reload",function(e){f&&(delete w.ssoSecondaryIframes["rp-iframe"],Object.keys(w.ssoSecondaryIframes).length<1&&window.onLoginStateChange&&"function"==typeof window.onLoginStateChange&&window.onLoginStateChange(),f=!1),initiateIframeChecks()}),window.addEventListener("rp-sync",function(e){T=T.filter(function(e){return"iframe-rp"!==e}),w.ssoSecondaryIframes["rp-iframe"]=function(){},f=!0,g+=1}),window.addEventListener("update-ui",function(e){window.onLoginStateChange&&"function"==typeof window.onLoginStateChange&&window.onLoginStateChange()}),window.postMessage&&(window.addEventListener?window.addEventListener("message",e,!1):window.attachEvent&&window.attachEvent("onmessage",e));var S='<div><div data-type="tpc-close" class="tpc-msgclose tpc-x">&times;</div><div class="tpc-copy"><div><p>We noticed that your browser does not allow third-party cookies. This could be because of security software, ad blockers or because you turned it off yourself. <a href="https://accounts.dowjones.com/assets/third-party-cookies.html" target="_blank">Learn more</a> about why and how we use third-party&nbsp;cookies.</p></div></div>',C='.tpc-msg{position: relative;background: #333;line-height:1.2;font: 0.8em "Whitney SSm", sans-serif;color: #fff;border: 1px solid #333;padding: 0.5em 1em;margin: 0;font: 0.9em/1.3em Helvetica,Arial,sans-serif;}.tpc-copy p{max-width: 620px;margin:0 auto;font-size:14px;}.tpc-copy a{color: #fff;}.tpc-copy > div{max-width:620px;margin:0 auto}.tpc-msg p{margin:0 0 0.4em;font-size:14px;line-height:1.7}.tpc-x{text-align:right;cursor:pointer;font-size:2em;font-weight:100}'}();